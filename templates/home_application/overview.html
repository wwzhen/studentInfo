<%inherit file="base.html"/>

<%block name="content">

<div class="page-content" id="background">
    <div class="col-md-4">
        <div id="chart1" style="height:500px;padding:10px;"></div>
    </div>
    <div class="col-md-4">
        <div id="chart2" style="height:500px;padding:10px;"></div>
    </div>
    <div class="col-md-4">
        <div id="chart3" style="height:500px;padding:10px;"></div>
    </div>
</div>
<script src="https://magicbox.bk.tencent.com/static_api/v3/assets/js/jquery-1.10.2.min.js"></script>
<script src="https://magicbox.bk.tencent.com/static_api/v3/assets/echarts-2.0/echarts-all.js"></script>
<script type="text/javascript">
    //chart4_demo1_js_start
    function createEPieChart(conf) {
        var myChart = echarts.init(document.getElementById(conf.selector));
        var aLegend = [];
        var series = conf.data.series;
        for (var i = 0; i < series.length; i++) {
            aLegend[i] = series[i].name;
        }
        // 填入数据
        myChart.setOption({
            title: {
                text: conf.data.title,
                subtext: '',
                x: 'center'
            },
            legend: {
                // x : 'left',
                y: 'bottom',
                data: aLegend
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            calculable: true,
            series: [{
                // 根据名字对应到相应的系列
                name: '访问来源',
                type: conf.chartType,
                data: series
            }]
        });
    }

    function initEPieChart(conf) {
        $.ajax({
            url: conf.url,
            type: 'GET',
            dataType: conf.dataType,
            success: function (res) {
                //获取数据成功
                if (res.result) {
                    var data = res.data;
                    createEPieChart({
                        selector: conf.containerId, // 图表容器
                        data: data, // 图表数据
                        chartType: conf.chartType
                    });
                }
            }
        });
    }

    function createEBarChart(conf) {
        var myChart = echarts.init(document.getElementById(conf.selector));
        var legendData = [];//存放变量的name
        for (var i = 0; i < conf.data.series.length; i++) {
            legendData.push(conf.data.series[i].name);
        }
        myChart.setOption({
            legend: {
                y: 'bottom',
                data: legendData
            },
            tooltip: {
                trigger: 'axis'
            },
            calculable: true,
            yAxis: [
                {
                    type: 'value',
                    splitArea: {show: true}
                }
            ],
            xAxis: conf.data.xAxis,
            series: conf.data.series
        })
    }

    function initEBarChart(conf) {
        $.ajax({
            url: conf.url,
            type: 'GET',
            dataType: conf.dataType,
            success: function (res) {
                //获取数据成功
                if (res.result) {
                    createEBarChart({
                        selector: conf.containerId, // 图表容器
                        data: res.data, // 图表数据
                    });
                }
            }
        })
    }

    function createEStandLineChart(conf) {
        var myChart = echarts.init(document.getElementById(conf.selector));
        var legendData = []
        for (var i = 0; i < conf.data.series.length; i++) {
            legendData.push(conf.data.series[i].name)
        }
        myChart.setOption({
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                y: 'bottom',
                data: legendData
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    data: conf.data.xAxis
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    splitArea: {show: true}
                }
            ],
            series: conf.data.series
        });
    }

    function initEStandLineChart(conf) {
        $.ajax({
            url: conf.url,
            type: 'GET',
            dataType: conf.dataType,
            success: function (res) {
                //获取数据成功
                if (res.result) {
                    createEStandLineChart({
                        selector: conf.containerId, // 图表容器
                        data: res.data, // 图表数据
                    });
                }
            }
        })
    }

    function setBackGroundImg() {
        let backDiv = document.getElementById("contentDiv");
        let imgUrl = static_url + "img/background2.jpg";
        backDiv.style.backgroundImage = "url('" + imgUrl + "')";
        backDiv.style.backgroundRepeat = "no-repeat";
        backDiv.style.backgroundSize = "100%";
    }

    $(function () {
        setBackGroundImg();
        initEPieChart({
            url: '/overview/student/chart/',
            dataType: 'json',
            containerId: 'chart1',
            chartType: 'pie'
        });
        initEBarChart({
            url: 'https://magicbox.bk.tencent.com/static_api/v3/components/chart2/demo.json',
            dataType: 'json',
            containerId: 'chart2',
            chartType: 'line'
        });
        initEStandLineChart({
            url: 'https://magicbox.bk.tencent.com/static_api/v3/components/chart3/demo.json',
            dataType: 'json',
            containerId: 'chart3',
            chartType: 'bar'
        });
    });
    //chart4_demo1_js_end
</script>
</%block>